<% if coupons.size > 0 %>
<table class="white-table">
  <thead>
    <th>
      Code
    </th>
    <th>
      Description
    </th>
    <th>
      Discount
    </th>
    <th>
      Minimum Order Amount
    </th>
    <th>
      Orders
    </th>
    <th>
      Reference
    </th>
    <th>
      Last Applied At
    </th>
    <th>
      Last Used At
    </th>
    <th>
      Created At
    </th>
    <th>
      Updated At
    </th>
    <th>
      Action
    </th>
  </thead>
  <tbody>
    <% coupons.each do |coupon| %>
    <tr>
      <td>
        <%= coupon.code %>
      </td>
      <td>
        <%= coupon.desc %>
      </td>
      <td>
        <%= coupon.decorate.discount_display %>
      </td>
      <td>
        <% if coupon.minimum_order %>
        <%= coupon.minimum_order.in_euro.display %> (<%= coupon.minimum_order.in_euro.to_yuan.display %>)
        <% end %>
      </td>
      <td>
        <%= coupon.orders.count %>
      </td>
      <td>
        <%= coupon.referrer&.reference_id %> (<%= coupon.referrer&.user&.decorate&.chinese_full_name %>)
      </td>
      <td>
        <%= coupon.last_applied_at %>
      </td>
      <td>
        <%= coupon.last_used_at %>
      </td>
      <td>
        <%= coupon.c_at %>
      </td>
      <td>
        <%= coupon.u_at %>
      </td>
      <td>
        <%= render partial: 'admin/coupons/table/action', :locals => { :coupon => coupon } %>
      </td>
    </tr>
  <% end %>
  </tbody>
</table>
<% else %>
<div class="+white-box +centered">
  <h4>
    No coupon found
  </h4>
</div>
<% end %>
